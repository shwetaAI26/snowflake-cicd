name: Deploy to Dev Environment 

 

on: 

  push: 

    branches: [ develop ] 

    paths: 

      - 'scripts/dev/**' 

      - 'config/dev.yml' 

 

jobs: 

  deploy-dev: 

    runs-on: ubuntu-latest 

     

    steps: 

    - name: Checkout code 

      uses: actions/checkout@v3 

     

    - name: Setup Python 

      uses: actions/setup-python@v4 

      with: 

        python-version: '3.9' 

     

    - name: Install dependencies 

      run: | 

        pip install snowflake-connector-python pyyaml 

     

    - name: Deploy to Dev 

      env: 

        SNOWFLAKE_ACCOUNT: ${{ secrets.SNOWFLAKE_ACCOUNT }} 

        SNOWFLAKE_USER: ${{ secrets.SNOWFLAKE_USER }} 

        SNOWFLAKE_PASSWORD: ${{ secrets.SNOWFLAKE_PASSWORD }} 

        SNOWFLAKE_ROLE: ${{ secrets.SNOWFLAKE_ROLE }} 

        SNOWFLAKE_WAREHOUSE: ${{ secrets.SNOWFLAKE_WAREHOUSE }} 

      run: | 

        python scripts/utils/deploy.py --environment dev 

     

    - name: Run Data Quality Checks 

      env: 

        SNOWFLAKE_ACCOUNT: ${{ secrets.SNOWFLAKE_ACCOUNT }} 

        SNOWFLAKE_USER: ${{ secrets.SNOWFLAKE_USER }} 

        SNOWFLAKE_PASSWORD: ${{ secrets.SNOWFLAKE_PASSWORD }} 

        SNOWFLAKE_ROLE: ${{ secrets.SNOWFLAKE_ROLE }} 

        SNOWFLAKE_WAREHOUSE: ${{ secrets.SNOWFLAKE_WAREHOUSE }} 

      run: | 

        python scripts/utils/data_quality_validator.py --environment dev 
